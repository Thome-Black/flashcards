<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FlashCards">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%231a1a2e' width='100' height='100' rx='20'/><text y='65' x='50' text-anchor='middle' font-size='50'>üìö</text></svg>">
    <title>FlashCards ‚Äî –£—á–∏ —Å–ª–æ–≤–∞</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Caveat:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f0f1a;
            --bg-secondary: #1a1a2e;
            --bg-card: #16213e;
            --accent: #e94560;
            --accent-glow: rgba(233, 69, 96, 0.4);
            --success: #4ecca3;
            --warning: #ffc93c;
            --text-primary: #eaeaea;
            --text-secondary: #a0a0a0;
            --text-muted: #6a6a8a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            min-height: 100dvh;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(233, 69, 96, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        body::after {
            content: '';
            position: fixed;
            bottom: -30%;
            left: -30%;
            width: 80%;
            height: 80%;
            background: radial-gradient(circle, rgba(78, 204, 163, 0.06) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .app {
            position: relative;
            z-index: 1;
            max-width: 480px;
            margin: 0 auto;
            padding: 16px;
            padding-top: max(16px, env(safe-area-inset-top));
            padding-bottom: max(16px, env(safe-area-inset-bottom));
            min-height: 100vh;
            min-height: 100dvh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .logo {
            font-family: 'Caveat', cursive;
            font-size: 24px;
            font-weight: 600;
            color: var(--accent);
            text-shadow: 0 0 20px var(--accent-glow);
        }

        .stats-mini {
            display: flex;
            gap: 10px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .stats-mini span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Navigation tabs - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é */
        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 12px;
            background: var(--bg-secondary);
            padding: 5px;
            border-radius: 14px;
        }

        .nav-tab {
            flex: 1 1 calc(50% - 5px);
            min-width: 0;
            padding: 9px 6px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 12px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        @media (min-width: 380px) {
            .nav-tab {
                flex: 1;
                font-size: 13px;
                padding: 10px 8px;
            }
        }

        .nav-tab.active {
            background: var(--bg-card);
            color: var(--text-primary);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* Sections */
        .section {
            display: none;
            flex: 1;
            flex-direction: column;
            animation: fadeIn 0.3s ease;
            overflow: hidden;
        }

        .section.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Category selector */
        .category-selector {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
            overflow-x: auto;
            padding-bottom: 6px;
            -webkit-overflow-scrolling: touch;
        }

        .category-selector::-webkit-scrollbar {
            display: none;
        }

        .category-chip {
            flex-shrink: 0;
            padding: 7px 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: transparent;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 12px;
            font-weight: 600;
            border-radius: 18px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .category-chip.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        /* Practice mode toggle */
        .practice-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg-secondary);
            padding: 10px 14px;
            border-radius: 12px;
            margin-bottom: 12px;
        }

        .practice-toggle-label {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .toggle-switch {
            position: relative;
            width: 46px;
            height: 26px;
            background: var(--bg-card);
            border-radius: 13px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: var(--success);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active::after {
            transform: translateX(20px);
        }

        /* Study section */
        .study-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 8px 0;
        }

        .empty-state {
            text-align: center;
            color: var(--text-secondary);
            padding: 24px 16px;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 10px;
            opacity: 0.6;
        }

        .empty-state h3 {
            font-size: 17px;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .empty-state p {
            font-size: 13px;
            line-height: 1.5;
        }

        /* Flashcard */
        .card-wrapper {
            width: 100%;
            max-width: 300px;
            perspective: 1000px;
        }

        .flashcard {
            position: relative;
            width: 100%;
            aspect-ratio: 3/4;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            inset: 0;
            backface-visibility: hidden;
            border-radius: 18px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 18px;
            text-align: center;
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 
                0 14px 40px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.05) inset;
        }

        .card-front {
            background: linear-gradient(145deg, var(--bg-card) 0%, #1a1a3a 100%);
        }

        .card-front::before {
            content: '';
            position: absolute;
            top: 8px;
            right: 8px;
            bottom: 8px;
            left: 8px;
            border: 2px solid rgba(233, 69, 96, 0.2);
            border-radius: 12px;
            pointer-events: none;
        }

        .card-back {
            transform: rotateY(180deg);
            background: linear-gradient(145deg, #1a2a4a 0%, var(--bg-card) 100%);
        }

        .card-category-badge {
            position: absolute;
            top: 14px;
            right: 14px;
            font-size: 10px;
            padding: 3px 8px;
            background: rgba(233, 69, 96, 0.3);
            color: var(--accent);
            border-radius: 10px;
            font-weight: 600;
        }

        .card-word {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 10px;
            line-height: 1.2;
            color: var(--text-primary);
        }

        .card-context {
            font-size: 12px;
            color: var(--text-secondary);
            font-style: italic;
            line-height: 1.4;
            max-height: 50px;
            overflow: hidden;
        }

        .card-translation {
            font-size: 22px;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 8px;
        }

        .card-hint {
            position: absolute;
            bottom: 14px;
            font-size: 10px;
            color: var(--text-muted);
        }

        /* Rating buttons */
        .rating-buttons {
            display: flex;
            gap: 6px;
            margin-top: 14px;
            width: 100%;
            max-width: 300px;
        }

        .rating-btn {
            flex: 1;
            padding: 12px 4px;
            border: none;
            border-radius: 12px;
            font-family: inherit;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .rating-btn:active {
            transform: scale(0.95);
        }

        .rating-btn.again {
            background: rgba(233, 69, 96, 0.2);
            color: var(--accent);
        }

        .rating-btn.hard {
            background: rgba(255, 201, 60, 0.2);
            color: var(--warning);
        }

        .rating-btn.good {
            background: rgba(78, 204, 163, 0.2);
            color: var(--success);
        }

        .rating-btn.easy {
            background: rgba(78, 204, 163, 0.3);
            color: var(--success);
        }

        .rating-btn span {
            font-size: 9px;
            font-weight: 400;
            opacity: 0.7;
        }

        /* Practice mode buttons */
        .practice-buttons {
            display: flex;
            gap: 10px;
            margin-top: 14px;
            width: 100%;
            max-width: 300px;
        }

        .practice-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-family: inherit;
            font-size: 13px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .practice-btn:active {
            transform: scale(0.95);
        }

        .practice-btn.knew {
            background: rgba(78, 204, 163, 0.2);
            color: var(--success);
        }

        .practice-btn.didnt-know {
            background: rgba(233, 69, 96, 0.2);
            color: var(--accent);
        }

        /* Progress */
        .progress-bar {
            width: 100%;
            max-width: 300px;
            height: 3px;
            background: var(--bg-secondary);
            border-radius: 2px;
            margin-bottom: 12px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--success));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .cards-count {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        /* Add card section */
        .add-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
            overflow-y: auto;
            flex: 1;
            padding-bottom: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .form-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input {
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        textarea.form-input {
            resize: none;
            min-height: 60px;
        }

        select.form-input {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23a0a0a0' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 36px;
        }

        .btn-primary {
            padding: 14px 18px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--accent), #c73e54);
            color: white;
            font-family: inherit;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 6px 20px var(--accent-glow);
            margin-top: 4px;
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: transparent;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-secondary:active {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Category management */
        .category-manager {
            margin-top: 14px;
            padding-top: 14px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .category-manager-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .add-category-row {
            display: flex;
            gap: 6px;
        }

        .add-category-row input {
            flex: 1;
        }

        .add-category-row button {
            padding: 12px 16px;
        }

        .categories-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 10px;
        }

        .category-tag {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: var(--bg-card);
            border-radius: 16px;
            font-size: 12px;
        }

        .category-tag button {
            background: none;
            border: none;
            color: var(--accent);
            font-size: 14px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }

        /* Cards list */
        .cards-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .cards-list-title {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .cards-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
            overflow-y: auto;
            padding-bottom: 16px;
        }

        .card-item {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .card-item-content {
            flex: 1;
            min-width: 0;
            cursor: pointer;
        }

        .card-item-word {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card-item-translation {
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card-item-category {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .card-item-actions {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .card-level {
            font-size: 9px;
            font-weight: 600;
            padding: 3px 7px;
            border-radius: 14px;
            background: rgba(78, 204, 163, 0.2);
            color: var(--success);
        }

        .card-level.new {
            background: rgba(233, 69, 96, 0.2);
            color: var(--accent);
        }

        .card-level.learning {
            background: rgba(255, 201, 60, 0.2);
            color: var(--warning);
        }

        .btn-icon {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-edit {
            background: rgba(78, 204, 163, 0.1);
            color: var(--success);
        }

        .btn-delete {
            background: rgba(233, 69, 96, 0.1);
            color: var(--accent);
        }

        /* Stats section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .stat-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 14px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .stat-value {
            font-size: 26px;
            font-weight: 800;
            margin-bottom: 2px;
        }

        .stat-value.accent { color: var(--accent); }
        .stat-value.success { color: var(--success); }
        .stat-value.warning { color: var(--warning); }

        .stat-label {
            font-size: 10px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .streak-card {
            grid-column: span 2;
            background: linear-gradient(135deg, var(--bg-card), #1a1a3a);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .streak-icon {
            font-size: 38px;
        }

        .streak-info {
            text-align: left;
        }

        .streak-value {
            font-size: 28px;
            font-weight: 800;
            color: var(--warning);
        }

        .streak-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
            padding: 16px;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background: var(--bg-secondary);
            border-radius: 18px;
            padding: 20px;
            width: 100%;
            max-width: 340px;
            max-height: 85vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 16px;
            text-align: center;
        }

        .modal-buttons {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        .modal-buttons button {
            flex: 1;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 10px 18px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 200;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Filter in cards list */
        .filter-row {
            display: flex;
            gap: 6px;
            margin-bottom: 10px;
        }

        .filter-row select {
            flex: 1;
            padding: 9px 10px;
            font-size: 12px;
        }

        /* Responsive for smaller screens */
        @media (max-height: 667px) {
            .flashcard {
                aspect-ratio: 1/1;
            }
            
            .card-word {
                font-size: 22px;
            }
            
            .card-translation {
                font-size: 20px;
            }
            
            .card-wrapper {
                max-width: 260px;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="logo">FlashCards ‚ú®</div>
            <div class="stats-mini">
                <span>üî• <span id="streakMini">0</span></span>
                <span>üìö <span id="totalMini">0</span></span>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="study">–£—á–∏—Ç—å</button>
            <button class="nav-tab" data-tab="add">–î–æ–±–∞–≤–∏—Ç—å</button>
            <button class="nav-tab" data-tab="cards">–ö–∞—Ä—Ç–æ—á–∫–∏</button>
            <button class="nav-tab" data-tab="stats">–°—Ç–∞—Ç-–∫–∞</button>
        </nav>

        <!-- Study Section -->
        <section id="study" class="section active">
            <div class="practice-toggle">
                <span class="practice-toggle-label">–†–µ–∂–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∏ (–≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏)</span>
                <div class="toggle-switch" id="practiceToggle" onclick="togglePracticeMode()"></div>
            </div>
            <div class="category-selector" id="studyCategorySelector"></div>
            <div class="study-container">
                <div id="studyContent"></div>
            </div>
        </section>

        <!-- Add Card Section -->
        <section id="add" class="section">
            <div class="add-form" id="addForm">
                <div class="form-group">
                    <label class="form-label">–°–ª–æ–≤–æ / –§—Ä–∞–∑–∞</label>
                    <input type="text" class="form-input" id="wordInput" placeholder="I won't give up!">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–µ—Ä–µ–≤–æ–¥</label>
                    <input type="text" class="form-input" id="translationInput" placeholder="–Ø –Ω–µ —Å–¥–∞–º—Å—è!">
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-input" id="categorySelect">
                        <option value="">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–æ–Ω—Ç–µ–∫—Å—Ç (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <textarea class="form-input" id="contextInput" placeholder="–û—Ç–∫—É–¥–∞ —Ñ—Ä–∞–∑–∞, –∫—Ç–æ —Å–∫–∞–∑–∞–ª..."></textarea>
                </div>
                <button type="button" class="btn-primary" onclick="addCard()">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É</button>
                
                <div class="category-manager">
                    <div class="category-manager-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</div>
                    <div class="add-category-row">
                        <input type="text" class="form-input" id="newCategoryInput" placeholder="–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è">
                        <button class="btn-secondary" onclick="addCategory()">+</button>
                    </div>
                    <div class="categories-list" id="categoriesList"></div>
                </div>
            </div>
        </section>

        <!-- Cards List Section -->
        <section id="cards" class="section">
            <div class="filter-row">
                <select class="form-input" id="filterCategory" onchange="renderCardsList()">
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                </select>
            </div>
            <div class="cards-list-header">
                <span class="cards-list-title" id="cardsListTitle">–í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏</span>
            </div>
            <div class="cards-list" id="cardsList"></div>
        </section>

        <!-- Stats Section -->
        <section id="stats" class="section">
            <div class="stats-grid">
                <div class="stat-card streak-card">
                    <div class="streak-icon">üî•</div>
                    <div class="streak-info">
                        <div class="streak-value" id="streakDays">0</div>
                        <div class="streak-label">–¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-value accent" id="totalCards">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value success" id="learnedCards">0</div>
                    <div class="stat-label">–í—ã—É—á–µ–Ω–æ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value warning" id="reviewsToday">0</div>
                    <div class="stat-label">–°–µ–≥–æ–¥–Ω—è</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="dueCards">0</div>
                    <div class="stat-label">–ö –ø–æ–≤—Ç–æ—Ä—É</div>
                </div>
            </div>
        </section>
    </div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <div class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</div>
            <div class="form-group">
                <label class="form-label">–°–ª–æ–≤–æ / –§—Ä–∞–∑–∞</label>
                <input type="text" class="form-input" id="editWordInput">
            </div>
            <div class="form-group">
                <label class="form-label">–ü–µ—Ä–µ–≤–æ–¥</label>
                <input type="text" class="form-input" id="editTranslationInput">
            </div>
            <div class="form-group">
                <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                <select class="form-input" id="editCategorySelect">
                    <option value="">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">–ö–æ–Ω—Ç–µ–∫—Å—Ç</label>
                <textarea class="form-input" id="editContextInput"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn-secondary" onclick="closeEditModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn-primary" onclick="saveCardEdit()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        const STORAGE_KEY = 'flashcards_data_v2';
        
        const defaultData = {
            cards: [],
            categories: [],
            stats: { streak: 0, lastStudyDate: null, reviewsToday: 0, todayDate: null }
        };

        function loadData() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const data = JSON.parse(saved);
                    if (!data.categories) data.categories = [];
                    const today = new Date().toDateString();
                    if (data.stats.todayDate !== today) {
                        data.stats.reviewsToday = 0;
                        data.stats.todayDate = today;
                        if (data.stats.lastStudyDate) {
                            const lastDate = new Date(data.stats.lastStudyDate);
                            const yesterday = new Date();
                            yesterday.setDate(yesterday.getDate() - 1);
                            if (lastDate.toDateString() !== yesterday.toDateString() && lastDate.toDateString() !== today) {
                                data.stats.streak = 0;
                            }
                        }
                    }
                    return data;
                }
            } catch (e) { console.error('Error loading data:', e); }
            return JSON.parse(JSON.stringify(defaultData));
        }

        function saveData(data) {
            try { localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }
            catch (e) { console.error('Error saving data:', e); }
        }

        let appData = loadData();
        let practiceMode = false;
        let selectedCategory = '';
        let editingCardId = null;
        let practiceCards = [];
        let practiceIndex = 0;

        function calculateNextReview(card, quality) {
            const now = Date.now();
            if (!card.interval) card.interval = 0;
            if (!card.easeFactor) card.easeFactor = 2.5;
            if (!card.repetitions) card.repetitions = 0;

            if (quality < 1) {
                card.repetitions = 0;
                card.interval = 1;
            } else {
                if (card.repetitions === 0) card.interval = 1;
                else if (card.repetitions === 1) card.interval = 10;
                else if (card.repetitions === 2) card.interval = 60 * 24;
                else card.interval = Math.round(card.interval * card.easeFactor);
                card.repetitions++;
                card.easeFactor = Math.max(1.3, card.easeFactor + (0.1 - (3 - quality) * (0.08 + (3 - quality) * 0.02)));
            }

            const multipliers = { 0: 0, 1: 0.5, 2: 1, 3: 1.5 };
            card.interval = Math.round(card.interval * (multipliers[quality] || 1));
            card.interval = Math.min(card.interval, 60 * 24 * 365);
            card.nextReview = now + card.interval * 60 * 1000;
            card.lastReview = now;
            return card;
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function getCardsToStudy() {
            const now = Date.now();
            let cards = appData.cards.filter(card => !card.nextReview || card.nextReview <= now);
            if (selectedCategory) cards = cards.filter(card => card.category === selectedCategory);
            return shuffleArray(cards);
        }

        function getPracticeCards() {
            let cards = [...appData.cards];
            if (selectedCategory) cards = cards.filter(card => card.category === selectedCategory);
            return shuffleArray(cards);
        }

        function getCardLevel(card) {
            if (!card.repetitions || card.repetitions === 0) return 'new';
            if (card.repetitions < 3) return 'learning';
            return 'learned';
        }

        function formatInterval(minutes) {
            if (minutes < 60) return `${minutes} –º–∏–Ω`;
            if (minutes < 60 * 24) return `${Math.round(minutes / 60)} —á`;
            return `${Math.round(minutes / (60 * 24))} –¥–Ω`;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        function renderCategorySelectors() {
            const studySelector = document.getElementById('studyCategorySelector');
            const addSelect = document.getElementById('categorySelect');
            const filterSelect = document.getElementById('filterCategory');
            const editSelect = document.getElementById('editCategorySelect');
            const categoriesList = document.getElementById('categoriesList');
            
            let chipsHtml = `<button class="category-chip ${!selectedCategory ? 'active' : ''}" onclick="selectStudyCategory('')">–í—Å–µ</button>`;
            appData.categories.forEach(cat => {
                chipsHtml += `<button class="category-chip ${selectedCategory === cat ? 'active' : ''}" onclick="selectStudyCategory('${escapeHtml(cat)}')">${escapeHtml(cat)}</button>`;
            });
            studySelector.innerHTML = chipsHtml;
            
            let optionsHtml = '<option value="">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>';
            appData.categories.forEach(cat => {
                optionsHtml += `<option value="${escapeHtml(cat)}">${escapeHtml(cat)}</option>`;
            });
            addSelect.innerHTML = optionsHtml;
            editSelect.innerHTML = optionsHtml;
            
            let filterHtml = '<option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>';
            appData.categories.forEach(cat => {
                filterHtml += `<option value="${escapeHtml(cat)}">${escapeHtml(cat)}</option>`;
            });
            filterSelect.innerHTML = filterHtml;

            let tagsHtml = '';
            appData.categories.forEach(cat => {
                tagsHtml += `<div class="category-tag">${escapeHtml(cat)} <button onclick="deleteCategory('${escapeHtml(cat)}')">√ó</button></div>`;
            });
            categoriesList.innerHTML = tagsHtml;
        }

        function selectStudyCategory(category) {
            selectedCategory = category;
            renderCategorySelectors();
            if (practiceMode) startPractice();
            else renderStudy();
        }

        function togglePracticeMode() {
            practiceMode = !practiceMode;
            document.getElementById('practiceToggle').classList.toggle('active', practiceMode);
            if (practiceMode) startPractice();
            else renderStudy();
        }

        function startPractice() {
            practiceCards = getPracticeCards();
            practiceIndex = 0;
            renderPractice();
        }

        function renderPractice() {
            const container = document.getElementById('studyContent');
            
            if (practiceCards.length === 0) {
                container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">üìù</div><h3>–ù–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫</h3><p>${selectedCategory ? '–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫' : '–î–æ–±–∞–≤—å—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏'}</p></div>`;
                return;
            }
            
            if (practiceIndex >= practiceCards.length) {
                container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">üéâ</div><h3>–ü—Ä–∞–∫—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h3><p>–í—ã –ø—Ä–æ—à–ª–∏ –≤—Å–µ ${practiceCards.length} –∫–∞—Ä—Ç–æ—á–µ–∫</p><button class="btn-primary" style="margin-top: 14px;" onclick="startPractice()">–ó–∞–Ω–æ–≤–æ</button></div>`;
                return;
            }

            const card = practiceCards[practiceIndex];
            container.innerHTML = `
                <div class="cards-count">${practiceIndex + 1} –∏–∑ ${practiceCards.length}</div>
                <div class="progress-bar"><div class="progress-fill" style="width: ${(practiceIndex / practiceCards.length) * 100}%"></div></div>
                <div class="card-wrapper">
                    <div class="flashcard" id="flashcard" onclick="flipCard()">
                        <div class="card-face card-front">
                            ${card.category ? `<div class="card-category-badge">${escapeHtml(card.category)}</div>` : ''}
                            <div class="card-word">${escapeHtml(card.word)}</div>
                            ${card.context ? `<div class="card-context">${escapeHtml(card.context)}</div>` : ''}
                            <div class="card-hint">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞</div>
                        </div>
                        <div class="card-face card-back">
                            <div class="card-translation">${escapeHtml(card.translation)}</div>
                            <div class="card-word" style="font-size: 16px; color: var(--text-secondary);">${escapeHtml(card.word)}</div>
                        </div>
                    </div>
                </div>
                <div class="practice-buttons" id="practiceButtons" style="opacity: 0; pointer-events: none;">
                    <button class="practice-btn didnt-know" onclick="practiceNext()">–ù–µ –∑–Ω–∞–ª</button>
                    <button class="practice-btn knew" onclick="practiceNext()">–ó–Ω–∞–ª</button>
                </div>`;
        }

        function practiceNext() {
            practiceIndex++;
            renderPractice();
        }

        function renderStudy() {
            const container = document.getElementById('studyContent');
            const cardsToStudy = getCardsToStudy();
            
            if (cardsToStudy.length === 0) {
                const totalInCategory = selectedCategory ? appData.cards.filter(c => c.category === selectedCategory).length : appData.cards.length;
                    
                if (totalInCategory === 0) {
                    container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">üìù</div><h3>–ü–æ–∫–∞ –ø—É—Å—Ç–æ</h3><p>${selectedCategory ? '–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫' : '–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É'}</p></div>`;
                } else {
                    let nextCard = appData.cards.filter(c => c.nextReview && (!selectedCategory || c.category === selectedCategory)).sort((a, b) => a.nextReview - b.nextReview)[0];
                    let nextTime = '';
                    if (nextCard) {
                        const diff = Math.max(0, nextCard.nextReview - Date.now());
                        const mins = Math.round(diff / 60000);
                        nextTime = mins < 60 ? `—á–µ—Ä–µ–∑ ${mins} –º–∏–Ω` : `—á–µ—Ä–µ–∑ ${Math.round(mins/60)} —á`;
                    }
                    container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">üéâ</div><h3>–í—Å—ë –ø–æ–≤—Ç–æ—Ä–µ–Ω–æ!</h3><p>–°–ª–µ–¥—É—é—â–µ–µ ${nextTime || '—Å–∫–æ—Ä–æ'}</p><p style="margin-top: 10px; font-size: 12px;">–í–∫–ª—é—á–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫—É –¥–ª—è –ø–æ–≤—Ç–æ—Ä–∞ –≤—Å–µ—Ö</p></div>`;
                }
                return;
            }

            const card = cardsToStudy[0];
            const total = cardsToStudy.length;
            const reviewed = appData.stats.reviewsToday;
            
            container.innerHTML = `
                <div class="cards-count">–û—Å—Ç–∞–ª–æ—Å—å: ${total}</div>
                <div class="progress-bar"><div class="progress-fill" style="width: ${Math.min(100, (reviewed / (reviewed + total)) * 100)}%"></div></div>
                <div class="card-wrapper">
                    <div class="flashcard" id="flashcard" onclick="flipCard()">
                        <div class="card-face card-front">
                            ${card.category ? `<div class="card-category-badge">${escapeHtml(card.category)}</div>` : ''}
                            <div class="card-word">${escapeHtml(card.word)}</div>
                            ${card.context ? `<div class="card-context">${escapeHtml(card.context)}</div>` : ''}
                            <div class="card-hint">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞</div>
                        </div>
                        <div class="card-face card-back">
                            <div class="card-translation">${escapeHtml(card.translation)}</div>
                            <div class="card-word" style="font-size: 16px; color: var(--text-secondary);">${escapeHtml(card.word)}</div>
                        </div>
                    </div>
                </div>
                <div class="rating-buttons" id="ratingButtons" style="opacity: 0; pointer-events: none;">
                    <button class="rating-btn again" onclick="rateCard('${card.id}', 0)">–°–Ω–æ–≤–∞<span>1–º</span></button>
                    <button class="rating-btn hard" onclick="rateCard('${card.id}', 1)">–°–ª–æ–∂–Ω–æ<span>${formatInterval(Math.round((card.interval || 1) * 0.5) || 5)}</span></button>
                    <button class="rating-btn good" onclick="rateCard('${card.id}', 2)">–•–æ—Ä–æ—à–æ<span>${formatInterval(card.interval || 10)}</span></button>
                    <button class="rating-btn easy" onclick="rateCard('${card.id}', 3)">–õ–µ–≥–∫–æ<span>${formatInterval(Math.round((card.interval || 10) * 1.5))}</span></button>
                </div>`;
        }

        function flipCard() {
            const flashcard = document.getElementById('flashcard');
            const ratingButtons = document.getElementById('ratingButtons');
            const practiceButtons = document.getElementById('practiceButtons');
            
            if (!flashcard.classList.contains('flipped')) {
                flashcard.classList.add('flipped');
                if (ratingButtons) { ratingButtons.style.opacity = '1'; ratingButtons.style.pointerEvents = 'auto'; }
                if (practiceButtons) { practiceButtons.style.opacity = '1'; practiceButtons.style.pointerEvents = 'auto'; }
            }
        }

        function rateCard(cardId, quality) {
            const cardIndex = appData.cards.findIndex(c => c.id === cardId);
            if (cardIndex !== -1) {
                appData.cards[cardIndex] = calculateNextReview(appData.cards[cardIndex], quality);
                appData.stats.reviewsToday++;
                const today = new Date().toDateString();
                if (appData.stats.lastStudyDate !== today) {
                    const lastDate = appData.stats.lastStudyDate ? new Date(appData.stats.lastStudyDate) : null;
                    const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
                    if (lastDate && lastDate.toDateString() === yesterday.toDateString()) appData.stats.streak++;
                    else if (!lastDate || lastDate.toDateString() !== today) appData.stats.streak = 1;
                    appData.stats.lastStudyDate = today;
                }
                saveData(appData);
                updateMiniStats();
                renderStudy();
            }
        }

        function renderCardsList() {
            const container = document.getElementById('cardsList');
            const filterCategory = document.getElementById('filterCategory').value;
            const titleEl = document.getElementById('cardsListTitle');
            
            let cards = [...appData.cards];
            if (filterCategory) { cards = cards.filter(c => c.category === filterCategory); titleEl.textContent = filterCategory; }
            else titleEl.textContent = '–í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏';
            
            if (cards.length === 0) {
                container.innerHTML = `<div class="empty-state"><div class="empty-state-icon">üìö</div><h3>–ù–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫</h3><p>${filterCategory ? '–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—É—Å—Ç–æ' : '–î–æ–±–∞–≤—å—Ç–µ —Å–ª–æ–≤–∞'}</p></div>`;
                return;
            }
            
            container.innerHTML = cards.map(card => {
                const level = getCardLevel(card);
                const levelText = { new: '–ù–æ–≤–∞—è', learning: '–£—á—É', learned: '–í—ã—É—á–µ–Ω–æ' }[level];
                return `<div class="card-item">
                    <div class="card-item-content" onclick="openEditModal('${card.id}')">
                        <div class="card-item-word">${escapeHtml(card.word)}</div>
                        <div class="card-item-translation">${escapeHtml(card.translation)}</div>
                        ${card.category ? `<div class="card-item-category">${escapeHtml(card.category)}</div>` : ''}
                    </div>
                    <div class="card-item-actions">
                        <span class="card-level ${level}">${levelText}</span>
                        <button class="btn-icon btn-edit" onclick="openEditModal('${card.id}')">‚úé</button>
                        <button class="btn-icon btn-delete" onclick="deleteCard('${card.id}')">√ó</button>
                    </div>
                </div>`;
            }).join('');
        }

        function renderStats() {
            const learned = appData.cards.filter(c => getCardLevel(c) === 'learned').length;
            const due = getCardsToStudy().length;
            document.getElementById('streakDays').textContent = appData.stats.streak;
            document.getElementById('totalCards').textContent = appData.cards.length;
            document.getElementById('learnedCards').textContent = learned;
            document.getElementById('reviewsToday').textContent = appData.stats.reviewsToday;
            document.getElementById('dueCards').textContent = due;
        }

        function updateMiniStats() {
            document.getElementById('streakMini').textContent = appData.stats.streak;
            document.getElementById('totalMini').textContent = appData.cards.length;
        }

        function addCard() {
            const word = document.getElementById('wordInput').value.trim();
            const translation = document.getElementById('translationInput').value.trim();
            const category = document.getElementById('categorySelect').value;
            const context = document.getElementById('contextInput').value.trim();
            
            if (!word || !translation) { showToast('–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –∏ –ø–µ—Ä–µ–≤–æ–¥'); return; }
            
            appData.cards.unshift({
                id: Date.now().toString(), word, translation, category, context,
                createdAt: Date.now(), interval: 0, easeFactor: 2.5, repetitions: 0, nextReview: null, lastReview: null
            });
            saveData(appData);
            updateMiniStats();
            document.getElementById('wordInput').value = '';
            document.getElementById('translationInput').value = '';
            document.getElementById('contextInput').value = '';
            showToast('–ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞! ‚ú®');
        }

        function deleteCard(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É?')) {
                appData.cards = appData.cards.filter(c => c.id !== id);
                saveData(appData);
                updateMiniStats();
                renderCardsList();
                if (practiceMode) startPractice(); else renderStudy();
                showToast('–£–¥–∞–ª–µ–Ω–æ');
            }
        }

        function addCategory() {
            const input = document.getElementById('newCategoryInput');
            const name = input.value.trim();
            if (!name) { showToast('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ'); return; }
            if (appData.categories.includes(name)) { showToast('–£–∂–µ –µ—Å—Ç—å'); return; }
            appData.categories.push(name);
            saveData(appData);
            input.value = '';
            renderCategorySelectors();
            showToast('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞');
        }

        function deleteCategory(name) {
            if (confirm(`–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é "${name}"? –ö–∞—Ä—Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.`)) {
                appData.categories = appData.categories.filter(c => c !== name);
                appData.cards.forEach(card => { if (card.category === name) card.category = ''; });
                saveData(appData);
                renderCategorySelectors();
                renderCardsList();
                showToast('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞');
            }
        }

        function openEditModal(cardId) {
            const card = appData.cards.find(c => c.id === cardId);
            if (!card) return;
            editingCardId = cardId;
            document.getElementById('editWordInput').value = card.word;
            document.getElementById('editTranslationInput').value = card.translation;
            document.getElementById('editCategorySelect').value = card.category || '';
            document.getElementById('editContextInput').value = card.context || '';
            document.getElementById('editModal').classList.add('show');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('show');
            editingCardId = null;
        }

        function saveCardEdit() {
            if (!editingCardId) return;
            const cardIndex = appData.cards.findIndex(c => c.id === editingCardId);
            if (cardIndex === -1) return;
            const word = document.getElementById('editWordInput').value.trim();
            const translation = document.getElementById('editTranslationInput').value.trim();
            if (!word || !translation) { showToast('–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –∏ –ø–µ—Ä–µ–≤–æ–¥'); return; }
            appData.cards[cardIndex].word = word;
            appData.cards[cardIndex].translation = translation;
            appData.cards[cardIndex].category = document.getElementById('editCategorySelect').value;
            appData.cards[cardIndex].context = document.getElementById('editContextInput').value.trim();
            saveData(appData);
            closeEditModal();
            renderCardsList();
            if (practiceMode) startPractice(); else renderStudy();
            showToast('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ');
        }

        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
                if (tab.dataset.tab === 'study') { if (practiceMode) renderPractice(); else renderStudy(); }
                if (tab.dataset.tab === 'cards') renderCardsList();
                if (tab.dataset.tab === 'stats') renderStats();
            });
        });

        document.getElementById('editModal').addEventListener('click', (e) => { if (e.target.id === 'editModal') closeEditModal(); });

        renderCategorySelectors();
        updateMiniStats();
        renderStudy();
    </script>
</body>
</html>
